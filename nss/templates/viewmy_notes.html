{% extends "usernav.html" %} {% load static %} {% block content %}
<div class="container mt-4">
  <div class="card border-0 shadow-sm rounded-3 bg-white">
    <div
      class="card-header bg-purple text-white d-flex align-items-center justify-content-between rounded-top"
    >
      <h2 class="mb-0">
        <i class="fas fa-file-alt me-2"></i>Your Personal Notes
      </h2>
      <a
        href="{% url 'upload_notes' %}"
        class="btn btn-amber btn-sm rounded-pill fw-bold"
      >
        Add New Note <i class="fas fa-plus"></i>
      </a>
    </div>
    <div class="card-body p-4">
      {% if notes %}
      <div class="table-responsive">
        <table class="table table-striped table-bordered align-middle">
          <thead class="bg-light text-dark">
            <tr>
              <th class="text-center">#</th>
              <th>Title</th>
              <th>Description</th>
              <th>Category</th>
              <th>Subject</th>
              <th>Uploaded By</th>
              <th>Date</th>
              <th>File</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for note in notes %}
            <tr>
              <td class="text-center">{{ forloop.counter }}</td>
              <td class="fw-bold text-purple">{{ note.title }}</td>
              <td>{{ note.description|truncatechars:50 }}</td>

              <td>
                {% if note.subject_id.category_id %}
                ({{note.subject_id.category_id.category_name }}) {% else %}
                <span class="text-muted">(No category)</span>
                {% endif %}
              </td>

              <td>{{ note.subject_id.subject_name }}</td>
              <td>{{ note.user_id.username }}</td>
              <td>{{ note.upload_date|date:"M d, Y" }}</td>
              <td>
                <a
                  href="{{ note.notes_file.url }}"
                  target="_blank"
                  class="btn btn-success btn-sm rounded-pill"
                >
                  <i class="fas fa-download"></i> Download
                </a>
              </td>
              <td>
                {% if note.note_id %}
                <a
                  href="{% url 'delete_mynotes' id=note.note_id %}"
                  class="btn btn-danger btn-sm rounded-pill"
                  onclick="return confirm('Are you sure you want to delete this note?')"
                >
                  <i class="fas fa-trash"></i> Delete
                </a>
                {% else %}
                <span class="text-danger">Invalid Note ID</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="alert alert-amber text-center rounded-3 p-4">
        <i class="fas fa-sticky-note fa-2x mb-2"></i>
        <p class="mb-0">
          No notes yet! Start building your knowledge vault by adding a new
          note.
        </p>
      </div>
      {% endif %}
    </div>
  </div>
</div>
<style>
  .card-header.bg-purple {
    background-color: #6f42c1 !important;
  }
  .btn-amber {
    background-color: #ffc107;
    color: #212529;
    border: none;
  }
  .btn-amber:hover {
    background-color: #e0a800;
    color: #212529;
  }
  .text-purple {
    color: #6f42c1 !important;
  }
  .alert-amber {
    background-color: #fff8e1;
    border-color: #ffecb3;
    color: #664d03;
  }
  .table th,
  .table td {
    vertical-align: middle;
  }
  .btn-sm {
    padding: 0.3rem 0.8rem;
  }
</style>
{% endblock %}
